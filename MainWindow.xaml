<!-- Copyright (c) 2025 Qz3rK -->
<!-- License: MIT (https://opensource.org/licenses/MIT) -->

<Window x:Class="DefragManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DefragManager"
        mc:Ignorable="d"
        Title="DeFRaG Manager" 
        Height="595" 
        Width="800"
        MinWidth="800"
        MaxWidth="800"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="CanResize"
        SnapsToDevicePixels="False"

        TextOptions.TextFormattingMode="Display"
        TextOptions.TextRenderingMode="ClearType"
        RenderOptions.ClearTypeHint="Enabled"

        UseLayoutRounding="True">
    
    <Window.Resources>
        <local:FavoriteToColorConverter x:Key="FavoriteColorConverter"/>
        <local:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>
        <FontFamily x:Key="EternalUiFont">pack://application:,,,/Assets/Fonts/#Eternal UI</FontFamily>

        <Style TargetType="{x:Type TextBlock}">
            <Setter Property="Foreground" Value="{DynamicResource TextColor}"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="ClearType"/>
            <Setter Property="RenderOptions.ClearTypeHint" Value="Enabled"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="False"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect 
                        Color="#FF000000"
                        Direction="315"
                        ShadowDepth="1"
                        BlurRadius="0"
                        Opacity="1"
                        RenderingBias="Quality"/>
                </Setter.Value>
            </Setter>
        </Style>

        <DropShadowEffect x:Key="ShadowEffect"
                  Color="#FF000000"
                  Direction="315"
                  ShadowDepth="1"
                  BlurRadius="0"
                  Opacity="1"
                  RenderingBias="Quality"/>

        <Style TargetType="{x:Type Label}" BasedOn="{StaticResource {x:Type Label}}">
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="ClearType"/>
            <Setter Property="RenderOptions.ClearTypeHint" Value="Enabled"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="False"/>
        </Style>
        <Style TargetType="{x:Type Control}" BasedOn="{StaticResource {x:Type Control}}"/>

        <Style TargetType="{x:Type DataGridRow}">
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <SolidColorBrush x:Key="VQ3HoverColor" Color="#FF8A4A4A"/> <!-- ÐÐ°ÑÑ‹Ñ‰ÐµÐ½Ð½Ñ‹Ð¹ ÑÐ²ÐµÑ‚Ð»Ð¾-ÐºÑ€Ð°ÑÐ½Ñ‹Ð¹ -->
        <SolidColorBrush x:Key="CPMHoverColor" Color="#FF4A4A8A"/> <!-- ÐÐ°ÑÑ‹Ñ‰ÐµÐ½Ð½Ñ‹Ð¹ ÑÐ²ÐµÑ‚Ð»Ð¾-ÑÐ¸Ð½Ð¸Ð¹ -->
        <SolidColorBrush x:Key="GreenHoverColor" Color="#FF4A8A4A"/> <!-- ÐÐ°ÑÑ‹Ñ‰ÐµÐ½Ð½Ñ‹Ð¹ ÑÐ²ÐµÑ‚Ð»Ð¾-Ð·ÐµÐ»ÐµÐ½Ñ‹Ð¹ -->
        <SolidColorBrush x:Key="TimeHoverColor" Color="#505050"/> <!-- ÐœÐ¾ÐºÑ€Ñ‹Ð¹ Ð°ÑÑ„Ð°Ð»ÑŒÑ‚ -->

        <!-- Ð¯Ñ€ÐºÐ¸Ðµ Ñ†Ð²ÐµÑ‚Ð° Ñ‚ÐµÐºÑÑ‚Ð° Ð´Ð»Ñ ÐºÐ½Ð¾Ð¿Ð¾Ðº -->
        <SolidColorBrush x:Key="VQ3TextColor" Color="#FFD44A4A"/> <!-- Ð¯Ñ€ÐºÐ¸Ð¹ ÐºÑ€Ð°ÑÐ½Ñ‹Ð¹ -->
        <SolidColorBrush x:Key="CPMTextColor" Color="#FF4A4AD4"/> <!-- Ð¯Ñ€ÐºÐ¸Ð¹ ÑÐ¸Ð½Ð¸Ð¹ -->
        
        <!-- Ð¦Ð²ÐµÑ‚Ð° Ð´Ð»Ñ Ñ‚ÐµÐ¼Ð½Ð¾Ð¹ Ñ‚ÐµÐ¼Ñ‹ -->
        <SolidColorBrush x:Key="BackgroundColor" Color="#1E1E1E"/>
        <SolidColorBrush x:Key="TextColor" Color="#E0E0E0"/>
        <SolidColorBrush x:Key="ButtonBackground" Color="#3D3D3D"/>
        <SolidColorBrush x:Key="AlternatingRowColor" Color="#2A2A2A"/>
        <SolidColorBrush x:Key="ThumbnailBackground" Color="#3A3A3A"/>
        <SolidColorBrush x:Key="TextBoxBackground" Color="#252525"/>
        <SolidColorBrush x:Key="SelectedTabColor" Color="#3D3D3D"/>
        <SolidColorBrush x:Key="ScrollBarThumb" Color="#606060"/>
        <SolidColorBrush x:Key="ScrollBarBackground" Color="#252525"/>
        <SolidColorBrush x:Key="ScrollBarArrow" Color="#808080"/>
        
        <Style x:Key="TimeButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#131313"/>
            <Setter Property="Foreground" Value="#00FFFF"/>
            <Setter Property="BorderBrush" Value="Black"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="ClearType"/>
            <Setter Property="RenderOptions.ClearTypeHint" Value="Enabled"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="False"/>
            <!-- Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð½Ñ‹Ð¹ ContentTemplate -->
            <Setter Property="ContentTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <TextBlock Text="{Binding}"
                                   Margin="0,-2,0,0"
                                   Foreground="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"
                                   Effect="{StaticResource ShadowEffect}"
                                   TextOptions.TextFormattingMode="Display"
                                   TextOptions.TextRenderingMode="ClearType"
                                   RenderOptions.ClearTypeHint="Enabled"/>
                    </DataTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="2"
                                TextOptions.TextFormattingMode="Display"
                                TextOptions.TextRenderingMode="ClearType"
                                RenderOptions.ClearTypeHint="Enabled"
                                UseLayoutRounding="True"
                                SnapsToDevicePixels="False">
                            <ContentPresenter HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            TextOptions.TextFormattingMode="Display"
                                            TextOptions.TextRenderingMode="ClearType"
                                            RenderOptions.ClearTypeHint="Enabled"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{DynamicResource TimeHoverColor}"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <Style x:Key="ActionButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource ButtonBackground}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextColor}"/>
            <Setter Property="BorderBrush" Value="Black"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="Padding" Value="5,2"/>
            <Setter Property="MinWidth" Value="80"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="2"
                                TextOptions.TextFormattingMode="Display"
                                TextOptions.TextRenderingMode="ClearType"
                                RenderOptions.ClearTypeHint="Enabled"
                                UseLayoutRounding="True"
                                SnapsToDevicePixels="False">
                            <ContentPresenter HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            TextOptions.TextFormattingMode="Display"
                                            TextOptions.TextRenderingMode="ClearType"
                                            RenderOptions.ClearTypeHint="Enabled"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <!-- Ð”Ð»Ñ ÐºÐ½Ð¾Ð¿Ð¾Ðº VQ3 -->
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="IsMouseOver" Value="True"/>
                        <Condition Property="Tag" Value="vq3"/>
                    </MultiTrigger.Conditions>
                    <Setter Property="Background" Value="{DynamicResource VQ3HoverColor}"/>
                </MultiTrigger>
                <!-- Ð”Ð»Ñ ÐºÐ½Ð¾Ð¿Ð¾Ðº CPM -->
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="IsMouseOver" Value="True"/>
                        <Condition Property="Tag" Value="cpm"/>
                    </MultiTrigger.Conditions>
                    <Setter Property="Background" Value="{DynamicResource CPMHoverColor}"/>
                </MultiTrigger>
                <!-- Ð”Ð»Ñ ÐºÐ½Ð¾Ð¿Ð¾Ðº Save Settings Ð¸ Rescan Maps -->
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="IsMouseOver" Value="True"/>
                        <Condition Property="Content" Value="Save Settings"/>
                    </MultiTrigger.Conditions>
                    <Setter Property="Background" Value="{DynamicResource GreenHoverColor}"/>
                </MultiTrigger>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="IsMouseOver" Value="True"/>
                        <Condition Property="Content" Value="Rescan Maps"/>
                    </MultiTrigger.Conditions>
                    <Setter Property="Background" Value="{DynamicResource GreenHoverColor}"/>
                </MultiTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="LaunchButtonStyle" TargetType="Button" BasedOn="{StaticResource ActionButtonStyle}">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="8,2,5,2"/>
            <Setter Property="Foreground" Value="{DynamicResource TextColor}"/>
        </Style>

        <Style TargetType="DataGrid">
            <Setter Property="Background" Value="{DynamicResource BackgroundColor}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextColor}"/>
            <Setter Property="BorderBrush" Value="Gray"/>
            <Setter Property="RowBackground" Value="{DynamicResource BackgroundColor}"/>
            <Setter Property="AlternatingRowBackground" Value="{DynamicResource AlternatingRowColor}"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="ScrollViewer.CanContentScroll" Value="True"/>
            <Setter Property="VirtualizingPanel.IsVirtualizing" Value="True"/>
            <Setter Property="VirtualizingPanel.VirtualizationMode" Value="Recycling"/>
            <Setter Property="EnableRowVirtualization" Value="True"/>
            <Setter Property="RowHeight" Value="50"/>
            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
            <Setter Property="VerticalContentAlignment" Value="Stretch"/>
            <!-- ... Ð¾ÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑÐ²Ð¾Ð¹ÑÑ‚Ð²Ð° ... -->
            <Setter Property="BorderBrush" Value="Black" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="ClearType"/>
            <Setter Property="RenderOptions.ClearTypeHint" Value="Enabled"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="False"/>
        </Style>
        
        <Style TargetType="DataGridCell">
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="Foreground" Value="{DynamicResource TextColor}"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="ClearType"/>
            <Setter Property="RenderOptions.ClearTypeHint" Value="Enabled"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="False"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridCell">
                        <Grid Background="{TemplateBinding Background}">
                            <ContentPresenter VerticalAlignment="Stretch" 
                                HorizontalAlignment="Stretch"
                                TextOptions.TextFormattingMode="Display"
                                TextOptions.TextRenderingMode="ClearType"
                                RenderOptions.ClearTypeHint="Enabled"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <DataTemplate x:Key="ThumbnailColumnTemplate">
            <Grid Width="100" Height="50" Margin="0">
                <Rectangle Fill="{DynamicResource ThumbnailBackground}" Stretch="Fill" Margin="0"/>
                <Image Source="{Binding Thumbnail}" 
                       Stretch="UniformToFill"
                       Margin="0"
                       RenderOptions.BitmapScalingMode="LowQuality">
                    <Image.Style>
                        <Style TargetType="Image">
                            <Setter Property="Visibility" Value="Visible"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Thumbnail}" Value="{x:Null}">
                                    <Setter Property="Visibility" Value="Collapsed"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Image.Style>
                </Image>
                <TextBlock Text="No preview" 
                           Foreground="{DynamicResource TextColor}"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           Margin="0"
                           Visibility="{Binding Thumbnail, Converter={StaticResource NullToVisibilityConverter}}"/>
            </Grid>
        </DataTemplate>

        <Style TargetType="TextBox">
            <Setter Property="Background" Value="{DynamicResource TextBoxBackground}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextColor}"/>
            <Setter Property="BorderBrush" Value="Black"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="CaretBrush" Value="{DynamicResource TextColor}"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="ClearType"/>
            <Setter Property="RenderOptions.ClearTypeHint" Value="Enabled"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="False"/>
        </Style>

        <Style TargetType="TabControl">
            <Setter Property="Background" Value="{DynamicResource BackgroundColor}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextColor}"/>
            <Setter Property="BorderBrush" Value="Black"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="ClearType"/>
            <Setter Property="RenderOptions.ClearTypeHint" Value="Enabled"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="False"/>
        </Style>

        <Style TargetType="TabItem">
            <Setter Property="Background" Value="{DynamicResource BackgroundColor}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextColor}"/>
            <Setter Property="BorderBrush" Value="Black"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="ClearType"/>
            <Setter Property="RenderOptions.ClearTypeHint" Value="Enabled"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="False"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Grid>
                            <Border Name="Border" 
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="1,1,1,0"
                                    Margin="0,0,-4,0">
                                <ContentPresenter x:Name="ContentSite"
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Center"
                                                ContentSource="Header"
                                                Margin="12,2,12,2"
                                                TextOptions.TextFormattingMode="Display"
                                                TextOptions.TextRenderingMode="ClearType"
                                                RenderOptions.ClearTypeHint="Enabled">
                                    <ContentPresenter.Effect>
                                        <DropShadowEffect 
                                            Color="#FF000000"
                                            Direction="315"
                                            ShadowDepth="1"
                                            BlurRadius="0"
                                            Opacity="1"
                                            RenderingBias="Quality"/>
                                    </ContentPresenter.Effect>
                                </ContentPresenter>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="{DynamicResource SelectedTabColor}"/>
                                <Setter TargetName="Border" Property="BorderThickness" Value="1,1,1,0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="ScrollViewer">
            <Setter Property="Background" Value="{DynamicResource BackgroundColor}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextColor}"/>
            <Setter Property="HorizontalScrollBarVisibility" Value="Disabled"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollViewer">
                        <Grid
                            TextOptions.TextFormattingMode="Display"
                            TextOptions.TextRenderingMode="ClearType"
                            RenderOptions.ClearTypeHint="Enabled"
                            UseLayoutRounding="True"
                            SnapsToDevicePixels="False">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <ScrollContentPresenter Grid.Column="0" Grid.Row="0"/>
                            
                            <!-- Ð’ÐµÑ€Ñ‚Ð¸ÐºÐ°Ð»ÑŒÐ½Ð°Ñ Ð¿Ð¾Ð»Ð¾ÑÐ° Ð¿Ñ€Ð¾ÐºÑ€ÑƒÑ‚ÐºÐ¸ - Ð²ÑÐµÐ³Ð´Ð° Ð²Ð¸Ð´Ð¸Ð¼Ð°Ñ -->
                            <ScrollBar x:Name="PART_VerticalScrollBar"
                                     Grid.Column="1"
                                     Grid.Row="0"
                                     Orientation="Vertical"
                                     Cursor="Arrow"
                                     ViewportSize="{TemplateBinding ViewportHeight}"
                                     Maximum="{TemplateBinding ScrollableHeight}"
                                     Minimum="0"
                                     Value="{TemplateBinding VerticalOffset}"
                                     Visibility="Visible"> <!-- Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¾ Ð½Ð° Ð²ÑÐµÐ³Ð´Ð° Visible -->
                                <ScrollBar.Style>
                                    <Style TargetType="ScrollBar">
                                        <Setter Property="Width" Value="8"/>
                                        <Setter Property="Background" Value="{DynamicResource ScrollBarBackground}"/>
                                        <Setter Property="Opacity" Value="0.5"/> <!-- ÐŸÐ¾Ð»ÑƒÐ¿Ñ€Ð¾Ð·Ñ€Ð°Ñ‡Ð½Ð°Ñ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ -->
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ScrollBar">
                                                    <Grid>
                                                        <Track x:Name="PART_Track" IsDirectionReversed="true">
                                                            <Track.Thumb>
                                                                <Thumb Background="{DynamicResource ScrollBarThumb}">
                                                                    <Thumb.Template>
                                                                        <ControlTemplate TargetType="Thumb">
                                                                            <Border Background="{TemplateBinding Background}"
                                                                                    CornerRadius="4"/>
                                                                        </ControlTemplate>
                                                                    </Thumb.Template>
                                                                </Thumb>
                                                            </Track.Thumb>
                                                        </Track>
                                                    </Grid>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <!-- ÐŸÑ€Ð¸ Ð½Ð°Ð²ÐµÐ´ÐµÐ½Ð¸Ð¸ Ð¸Ð»Ð¸ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸ Ð´ÐµÐ»Ð°ÐµÐ¼ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð²Ð¸Ð´Ð¸Ð¼Ð¾Ð¹ -->
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Opacity" Value="1"/>
                                            </Trigger>
                                            <Trigger Property="IsEnabled" Value="True">
                                                <Setter Property="Opacity" Value="1"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </ScrollBar.Style>
                            </ScrollBar>
                            
                            <!-- Ð“Ð¾Ñ€Ð¸Ð·Ð¾Ð½Ñ‚Ð°Ð»ÑŒÐ½Ð°Ñ Ð¿Ð¾Ð»Ð¾ÑÐ° (Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð° ÐºÐ°Ðº Ð±Ñ‹Ð»Ð¾) -->
                            <ScrollBar x:Name="PART_HorizontalScrollBar"
                                     Grid.Column="0"
                                     Grid.Row="1"
                                     Orientation="Horizontal"
                                     Cursor="Arrow"
                                     ViewportSize="{TemplateBinding ViewportWidth}"
                                     Maximum="{TemplateBinding ScrollableWidth}"
                                     Minimum="0"
                                     Value="{TemplateBinding HorizontalOffset}"
                                     Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Ð¡Ñ‚Ð¸Ð»ÑŒ Ð´Ð»Ñ ÐºÐ½Ð¾Ð¿Ð¾Ðº Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ° Ð¾ÐºÐ½Ð° -->
        <Style x:Key="TitleButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"
                                TextOptions.TextFormattingMode="Display"
                                TextOptions.TextRenderingMode="ClearType"
                                RenderOptions.ClearTypeHint="Enabled"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#3A3A3A"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

<Grid>
    <!-- ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€ Ñ Ð·Ð°ÐºÑ€ÑƒÐ³Ð»Ñ‘Ð½Ð½Ñ‹Ð¼Ð¸ ÑƒÐ³Ð»Ð°Ð¼Ð¸ -->
    <Border Background="{DynamicResource BackgroundColor}" 
            CornerRadius="2" 
            SnapsToDevicePixels="True">
        
        <!-- Ð“Ð»Ð°Ð²Ð½Ñ‹Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€ Ñ ÑÐ²Ð½Ñ‹Ð¼ Ñ€Ð°Ð·Ð´ÐµÐ»ÐµÐ½Ð¸ÐµÐ¼ Ð½Ð° Ð¾Ð±Ð»Ð°ÑÑ‚Ð¸ -->
        <Grid>
            <!-- ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ Ð¾Ð±Ð»Ð°ÑÑ‚Ð¸ Ð´Ð»Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ñ€Ð°Ð·Ð¼ÐµÑ€Ð° -->
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3"/> <!-- Ð›ÐµÐ²Ñ‹Ð¹ ÐºÑ€Ð°Ð¹ -->
                <ColumnDefinition Width="*"/>  <!-- Ð¦ÐµÐ½Ñ‚Ñ€ -->
                <ColumnDefinition Width="3"/> <!-- ÐŸÑ€Ð°Ð²Ñ‹Ð¹ ÐºÑ€Ð°Ð¹ -->
            </Grid.ColumnDefinitions>
            
            <Grid.RowDefinitions>
                <RowDefinition Height="3"/>   <!-- Ð’ÐµÑ€Ñ…Ð½Ð¸Ð¹ ÐºÑ€Ð°Ð¹ -->
                <RowDefinition Height="*"/>    <!-- Ð¦ÐµÐ½Ñ‚Ñ€ -->
                <RowDefinition Height="3"/>   <!-- ÐÐ¸Ð¶Ð½Ð¸Ð¹ ÐºÑ€Ð°Ð¹ -->
            </Grid.RowDefinitions>
            
            <!-- Ð’ÐµÑ€Ñ…Ð½Ð¸Ð¹ ÐºÑ€Ð°Ð¹ (Ð¿Ð¾Ð»Ð¾ÑÐ°) -->
            <Border Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3" 
                    Cursor="SizeNS" Background="Transparent"
                    MouseLeftButtonDown="ResizeWindow_Top"/>
            
            <!-- ÐÐ¸Ð¶Ð½Ð¸Ð¹ ÐºÑ€Ð°Ð¹ (Ð¿Ð¾Ð»Ð¾ÑÐ°) -->
            <Border Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" 
                    Cursor="SizeNS" Background="Transparent"
                    MouseLeftButtonDown="ResizeWindow_Bottom"/>
            
            <!-- Ð£Ð³Ð»Ñ‹ (Ð¿ÐµÑ€ÐµÐºÑ€Ñ‹Ð²Ð°ÑŽÑ‚ Ð¿ÐµÑ€ÐµÑÐµÑ‡ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð»Ð¾Ñ) -->
            <!-- Ð›ÐµÐ²Ñ‹Ð¹ Ð²ÐµÑ€Ñ…Ð½Ð¸Ð¹ -->
            <Border Grid.Row="0" Grid.Column="0" 
                    Cursor="SizeNWSE" Background="Transparent"
                    MouseLeftButtonDown="ResizeWindow_TopLeft"/>
            
            <!-- ÐŸÑ€Ð°Ð²Ñ‹Ð¹ Ð²ÐµÑ€Ñ…Ð½Ð¸Ð¹ -->
            <Border Grid.Row="0" Grid.Column="2" 
                    Cursor="SizeNESW" Background="Transparent"
                    MouseLeftButtonDown="ResizeWindow_TopRight"/>
            
            <!-- Ð›ÐµÐ²Ñ‹Ð¹ Ð½Ð¸Ð¶Ð½Ð¸Ð¹ -->
            <Border Grid.Row="2" Grid.Column="0" 
                    Cursor="SizeNESW" Background="Transparent"
                    MouseLeftButtonDown="ResizeWindow_BottomLeft"/>
            
            <!-- ÐŸÑ€Ð°Ð²Ñ‹Ð¹ Ð½Ð¸Ð¶Ð½Ð¸Ð¹ -->
            <Border Grid.Row="2" Grid.Column="2" 
                    Cursor="SizeNWSE" Background="Transparent"
                    MouseLeftButtonDown="ResizeWindow_BottomRight"/>
            
            <!-- ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ðµ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ Ð¾ÐºÐ½Ð° -->
            <Grid Grid.Row="1" Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="27"/> <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº -->
                    <RowDefinition Height="*"/>  <!-- ÐšÐ¾Ð½Ñ‚ÐµÐ½Ñ‚ -->
                </Grid.RowDefinitions>
                
            <!-- ÐŸÐ°Ð½ÐµÐ»ÑŒ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ° -->
            <Border Grid.Row="0" 
                    Background="#1E1E1E" 
                    CornerRadius="5,5,0,0"
                    MouseLeftButtonDown="TitleBar_MouseLeftButtonDown"
                    SnapsToDevicePixels="True">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Image Grid.Column="0"
                           Source="/Assets/Icons/icon.png"
                           Width="20"
                           Height="20"
                           Margin="5,0,5,0"
                           VerticalAlignment="Center"
                           SnapsToDevicePixels="True"
                           RenderOptions.BitmapScalingMode="HighQuality"/>

                    <TextBlock Grid.Column="1"
                               VerticalAlignment="Center"
                               Margin="0,0,0,0"
                               FontSize="14"
                               TextOptions.TextFormattingMode="Ideal"
                               TextOptions.TextRenderingMode="ClearType"
                               TextOptions.TextHintingMode="Animated"
                               RenderOptions.ClearTypeHint="Enabled"
                               UseLayoutRounding="True">
                        <Run Text="DeFRaG Manager" 
                             FontFamily="{StaticResource EternalUiFont}"
                             Foreground="White"/>
                        <Run Text=" | " 
                             FontFamily="Segoe UI" 
                             FontWeight="Bold"
                             Foreground="White"/>
                        <Run Text="{Binding WindowTitle}" 
                             FontFamily="Segoe UI" 
                             FontWeight="Bold"
                             Foreground="White"/>
                    </TextBlock>
                    
                    <!-- ÐšÐ½Ð¾Ð¿ÐºÐ¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð¾ÐºÐ½Ð¾Ð¼ (Ð¿ÐµÑ€ÐµÐ½ÐµÑÐµÐ½Ð¾ Ð² Grid.Column="2") -->
                    <StackPanel Grid.Column="2"
                               Orientation="Horizontal" 
                               HorizontalAlignment="Right">
                        <Button Content="â”€" Style="{StaticResource TitleButtonStyle}" Click="MinimizeWindow"/>
                        <Button Content="â–¡" Style="{StaticResource TitleButtonStyle}" Click="MaximizeWindow"/>
                        <Button Content="âœ•" Style="{StaticResource TitleButtonStyle}" Click="CloseWindow"/>
                    </StackPanel>
                </Grid>
            </Border>
                
                <!-- ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ðµ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ -->
                <Border Grid.Row="1" CornerRadius="0,0,5,5">
                    <TabControl Background="{DynamicResource BackgroundColor}" SelectionChanged="TabControl_SelectionChanged">
                        <TabItem x:Name="AllMapsTab">
                            <TabItem.Header>
                                <TextBlock VerticalAlignment="Center"
                                           Margin="-6,-2,0,0"
                                           Padding="0"
                                           TextOptions.TextFormattingMode="Ideal"
                                           TextOptions.TextRenderingMode="ClearType"
                                           TextOptions.TextHintingMode="Animated"
                                           RenderOptions.ClearTypeHint="Enabled"
                                           UseLayoutRounding="True"
                                           SnapsToDevicePixels="False">
                                    <Span>
                                        <Run Text="ðŸ”" 
                                             Foreground="DodgerBlue"
                                             FontSize="15"/>
                                        <Run Text="All Maps"
                                             FontFamily="{StaticResource EternalUiFont}"
                                             FontSize="14"/>
                                    </Span>
                                </TextBlock>
                            </TabItem.Header>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                
                                <TextBox x:Name="SearchBox" 
                                         Margin="5" 
                                         TextChanged="SearchBox_TextChanged"
                                         Grid.Row="0"/>
                                
                                <ScrollViewer x:Name="MapsGridScroll" 
                                              VerticalScrollBarVisibility="Auto"
                                              ScrollChanged="MapsGrid_ScrollChanged"
                                              Grid.Row="1"
                                              PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                                    <DataGrid x:Name="MapsGrid" 
                                              AutoGenerateColumns="False" 
                                              HeadersVisibility="None"
                                              VirtualizingPanel.ScrollUnit="Pixel"
                                              RowHeight="50">
                                        <DataGrid.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <VirtualizingStackPanel VirtualizationMode="Recycling"/>
                                            </ItemsPanelTemplate>
                                        </DataGrid.ItemsPanel>
                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn Width="100" 
                                                                    CellTemplate="{StaticResource ThumbnailColumnTemplate}"/>
                                            <DataGridTextColumn Binding="{Binding Name}" 
                                                                Width="*">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Foreground" Value="#FFE5E5E5"/>
                                                        <Setter Property="Padding" Value="10,0"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="FontFamily" Value="Segoe UI"/>
                                                        <Setter Property="FontWeight" Value="Bold"/>
                                                        <Setter Property="FontSize" Value="14"/>                                                      
                                                        <Setter Property="TextOptions.TextFormattingMode" Value="Ideal"/>
                                                        <Setter Property="TextOptions.TextRenderingMode" Value="ClearType"/>
                                                        <Setter Property="TextOptions.TextHintingMode" Value="Animated"/>
                                                        <Setter Property="RenderOptions.ClearTypeHint" Value="Enabled"/>
                                                        <Setter Property="UseLayoutRounding" Value="True"/>
                                                        <Setter Property="SnapsToDevicePixels" Value="False"/>
                                                        <Setter Property="Effect">
                                                            <Setter.Value>
                                                                <DropShadowEffect 
                                                                    Color="#FF000000"
                                                                    Direction="315"
                                                                    ShadowDepth="1"
                                                                    BlurRadius="0"
                                                                    Opacity="1"
                                                                    RenderingBias="Quality"/>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTemplateColumn Width="100">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Button Content="{Binding VQ3Time}" 
                                                                Tag="vq3" 
                                                                Click="PlayDemo_Click"
                                                                Style="{StaticResource TimeButtonStyle}"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTemplateColumn Width="100">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Button Content="{Binding CPMTime}" 
                                                                Tag="cpm" 
                                                                Click="PlayDemo_Click"
                                                                Style="{StaticResource TimeButtonStyle}"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTemplateColumn Width="50">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Button Click="ToggleFavorite_Click"
                                                                Background="Transparent"
                                                                BorderThickness="0"
                                                                Padding="0">
                                                            <TextBlock Text="â˜…" 
                                                                       FontSize="19"
                                                                       Margin="0,2,0,0"
                                                                       Foreground="{Binding IsFavorite, Converter={StaticResource FavoriteColorConverter}}">
                                                                <TextBlock.Effect>
                                                                    <DropShadowEffect 
                                                                        Color="#FF000000"
                                                                        Direction="315"
                                                                        ShadowDepth="1"
                                                                        BlurRadius="0"
                                                                        Opacity="1"
                                                                        RenderingBias="Quality"/>
                                                                </TextBlock.Effect>
                                                            </TextBlock>
                                                        </Button>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTemplateColumn Width="100">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Button Tag="vq3" 
                                                                Click="LaunchMap_Click"
                                                                Style="{StaticResource LaunchButtonStyle}">
                                                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,-1,0,0">
                                                                <TextBlock Text="VQ3" 
                                                                         Foreground="{StaticResource VQ3TextColor}"
                                                                         Effect="{StaticResource ShadowEffect}"/>
                                                                <TextBlock Text=" â–¶" 
                                                                         Foreground="{StaticResource VQ3TextColor}"
                                                                         Margin="3,0,0,0"
                                                                         Effect="{StaticResource ShadowEffect}"/>
                                                            </StackPanel>
                                                        </Button>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTemplateColumn Width="100">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Button Tag="cpm" 
                                                                Click="LaunchMap_Click"
                                                                Style="{StaticResource LaunchButtonStyle}">
                                                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,-1,0,0">
                                                                <TextBlock Text="CPM" 
                                                                         Foreground="{StaticResource CPMTextColor}"
                                                                         Effect="{StaticResource ShadowEffect}"/>
                                                                <TextBlock Text=" â–¶" 
                                                                         Foreground="{StaticResource CPMTextColor}"
                                                                         Margin="3,0,0,0"
                                                                         Effect="{StaticResource ShadowEffect}"/>
                                                            </StackPanel>
                                                        </Button>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </ScrollViewer>
                            </Grid>
                        </TabItem>
                        <TabItem x:Name="FavoritesTab">
                            <TabItem.Header>
                                <!-- Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ ClipToBounds Ð¸ Ð¾Ñ‚Ñ€Ð¸Ñ†Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ‚ÑÑ‚ÑƒÐ¿Ñ‹ -->
                                <Grid VerticalAlignment="Center" 
                                      Margin="-6,-8,0,-8"
                                      SnapsToDevicePixels="True"
                                      ClipToBounds="True">
                                    
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/> <!-- Ð”Ð»Ñ Ð·Ð²ÐµÐ·Ð´Ñ‹ -->
                                        <ColumnDefinition Width="Auto"/> <!-- Ð”Ð»Ñ Ñ‚ÐµÐºÑÑ‚Ð° -->
                                    </Grid.ColumnDefinitions>

                                    <!-- Ð—Ð²ÐµÐ·Ð´Ð° Ñ ÑƒÐ²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð½Ñ‹Ð¼ Ñ€Ð°Ð·Ð¼ÐµÑ€Ð¾Ð¼ Ð¸ Ð¾Ñ‚Ñ€Ð¸Ñ†Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¼ Ð¾Ñ‚ÑÑ‚ÑƒÐ¿Ð¾Ð¼ -->
                                    <TextBlock Grid.Column="0"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Center"
                                               Margin="0,-9,2,-5"
                                               Text="â˜…"
                                               Foreground="Gold"
                                               FontSize="21"
                                               TextOptions.TextFormattingMode="Ideal"
                                               TextOptions.TextRenderingMode="ClearType"
                                               TextOptions.TextHintingMode="Animated"
                                               RenderOptions.ClearTypeHint="Enabled"
                                               UseLayoutRounding="True"
                                               SnapsToDevicePixels="False">
                                        <TextBlock.RenderTransform>
                                            <!-- ÐœÐ°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð½Ð° 5% (Ð¿Ñ€Ð¸Ð¼ÐµÑ€: Ð´Ð»Ñ FontSize="21" â†’ 22.05) -->
                                            <ScaleTransform ScaleX="1.0238" ScaleY="1.0238" />
                                        </TextBlock.RenderTransform>
                                    </TextBlock>

                                    <!-- Ð¢ÐµÐºÑÑ‚ Ñ Ñ„Ð¸ÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¼ Ñ€Ð°Ð·Ð¼ÐµÑ€Ð¾Ð¼ -->
                                    <TextBlock Grid.Column="1"
                                               VerticalAlignment="Center"
                                               Text="Favorites"
                                               FontFamily="{StaticResource EternalUiFont}"
                                               Margin="2,0,0,0"
                                               TextOptions.TextFormattingMode="Ideal"
                                               TextOptions.TextRenderingMode="ClearType"
                                               TextOptions.TextHintingMode="Animated"
                                               RenderOptions.ClearTypeHint="Enabled"
                                               UseLayoutRounding="True"
                                               SnapsToDevicePixels="False"
                                               FontSize="14"/>
                                </Grid>
                            </TabItem.Header>
                            <ScrollViewer x:Name="FavoritesScroll" 
                                          VerticalScrollBarVisibility="Auto" 
                                          ScrollChanged="FavoritesScroll_ScrollChanged"
                                          PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                                <DataGrid x:Name="FavoritesGrid" 
                                          AutoGenerateColumns="False" 
                                          HeadersVisibility="None">
                                    <DataGrid.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <VirtualizingStackPanel VirtualizationMode="Recycling"/>
                                        </ItemsPanelTemplate>
                                    </DataGrid.ItemsPanel>
                                    <DataGrid.Columns>
                                        <DataGridTemplateColumn Width="100" 
                                                                CellTemplate="{StaticResource ThumbnailColumnTemplate}"/>
                                        <DataGridTextColumn Binding="{Binding Name}" 
                                                            Width="*">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Foreground" Value="#FFE5E5E5"/>
                                                    <Setter Property="Padding" Value="10,0"/>
                                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                                    <Setter Property="FontFamily" Value="Segoe UI"/>
                                                    <Setter Property="FontWeight" Value="Bold"/>
                                                    <Setter Property="FontSize" Value="14"/>
                                                    <Setter Property="TextOptions.TextFormattingMode" Value="Ideal"/>
                                                    <Setter Property="TextOptions.TextRenderingMode" Value="ClearType"/>
                                                    <Setter Property="TextOptions.TextHintingMode" Value="Animated"/>
                                                    <Setter Property="RenderOptions.ClearTypeHint" Value="Enabled"/>
                                                    <Setter Property="UseLayoutRounding" Value="True"/>
                                                    <Setter Property="SnapsToDevicePixels" Value="False"/>
                                                    <Setter Property="Effect">
                                                        <Setter.Value>
                                                            <DropShadowEffect 
                                                                Color="#FF000000"
                                                                Direction="315"
                                                                ShadowDepth="1"
                                                                BlurRadius="0"
                                                                Opacity="1"
                                                                RenderingBias="Quality"/>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTemplateColumn Width="100">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Content="{Binding VQ3Time}" 
                                                            Tag="vq3" 
                                                            Click="PlayDemo_Click"
                                                            Style="{StaticResource TimeButtonStyle}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Width="100">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Content="{Binding CPMTime}" 
                                                            Tag="cpm" 
                                                            Click="PlayDemo_Click"
                                                            Style="{StaticResource TimeButtonStyle}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Width="50">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Click="ToggleFavorite_Click"
                                                            Background="Transparent"
                                                            BorderThickness="0"
                                                            Padding="0">
                                                        <TextBlock Text="â˜…" 
                                                                   FontSize="19"
                                                                   Margin="0,2,0,0"
                                                                   Foreground="{Binding IsFavorite, Converter={StaticResource FavoriteColorConverter}}">
                                                            <TextBlock.Effect>
                                                                <DropShadowEffect 
                                                                    Color="#FF000000"
                                                                    Direction="315"
                                                                    ShadowDepth="1"
                                                                    BlurRadius="0"
                                                                    Opacity="1"
                                                                    RenderingBias="Quality"/>
                                                            </TextBlock.Effect>
                                                        </TextBlock>
                                                    </Button>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Width="100">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Tag="vq3" 
                                                            Click="LaunchMap_Click"
                                                            Style="{StaticResource LaunchButtonStyle}">
                                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,-1,0,0">
                                                            <TextBlock Text="VQ3" 
                                                                     Foreground="{StaticResource VQ3TextColor}"
                                                                     Effect="{StaticResource ShadowEffect}"/>
                                                            <TextBlock Text=" â–¶" 
                                                                     Foreground="{StaticResource VQ3TextColor}"
                                                                     Margin="3,0,0,0"
                                                                     Effect="{StaticResource ShadowEffect}"/>
                                                        </StackPanel>
                                                    </Button>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Width="100">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Tag="cpm" 
                                                            Click="LaunchMap_Click"
                                                            Style="{StaticResource LaunchButtonStyle}">
                                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,-1,0,0">
                                                            <TextBlock Text="CPM" 
                                                                     Foreground="{StaticResource CPMTextColor}" Effect="{StaticResource ShadowEffect}"/>
                                                            <TextBlock Text=" â–¶" 
                                                                     Foreground="{StaticResource CPMTextColor}" 
                                                                     Margin="3,0,0,0" 
                                                                     Effect="{StaticResource ShadowEffect}"/>
                                                        </StackPanel>
                                                    </Button>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </ScrollViewer>
                        </TabItem>
                        
                        <TabItem x:Name="RecentTab">
                            <TabItem.Header>
                                <TextBlock VerticalAlignment="Center"
                                           Margin="-6,-2,0,0"
                                           Padding="0"
                                           TextOptions.TextFormattingMode="Ideal"
                                           TextOptions.TextRenderingMode="ClearType"
                                           TextOptions.TextHintingMode="Animated"
                                           RenderOptions.ClearTypeHint="Enabled"
                                           UseLayoutRounding="True"
                                           SnapsToDevicePixels="False">
                                    <Span>
                                        <Run Text="ðŸ•’" 
                                             Foreground="LightGreen"
                                             FontSize="15"/>
                                        <Run Text="Recent"
                                             FontFamily="{StaticResource EternalUiFont}"
                                             FontSize="14"/>
                                    </Span>
                                </TextBlock>
                            </TabItem.Header>
                            <ScrollViewer x:Name="RecentScroll"
                                          VerticalScrollBarVisibility="Auto"
                                          PreviewMouseWheel="ScrollViewer_PreviewMouseWheel"
                                          ScrollChanged="RecentScroll_ScrollChanged">
                                <DataGrid x:Name="RecentGrid" 
                                          AutoGenerateColumns="False" 
                                          HeadersVisibility="None">
                                    <DataGrid.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <VirtualizingStackPanel VirtualizationMode="Recycling"/>
                                        </ItemsPanelTemplate>
                                    </DataGrid.ItemsPanel>
                                    <DataGrid.Columns>
                                        <DataGridTemplateColumn Width="100" 
                                                                CellTemplate="{StaticResource ThumbnailColumnTemplate}"/>
                                        <DataGridTextColumn Binding="{Binding Name}" 
                                                            Width="*">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Foreground" Value="#FFE5E5E5"/>
                                                    <Setter Property="Padding" Value="10,0"/>
                                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                                    <Setter Property="FontFamily" Value="Segoe UI"/>
                                                    <Setter Property="FontWeight" Value="Bold"/>
                                                    <Setter Property="FontSize" Value="14"/>
                                                    <Setter Property="TextOptions.TextFormattingMode" Value="Ideal"/>
                                                    <Setter Property="TextOptions.TextRenderingMode" Value="ClearType"/>
                                                    <Setter Property="TextOptions.TextHintingMode" Value="Animated"/>
                                                    <Setter Property="RenderOptions.ClearTypeHint" Value="Enabled"/>
                                                    <Setter Property="UseLayoutRounding" Value="True"/>
                                                    <Setter Property="SnapsToDevicePixels" Value="False"/>
                                                    <Setter Property="Effect">
                                                        <Setter.Value>
                                                            <DropShadowEffect 
                                                                Color="#FF000000"
                                                                Direction="315"
                                                                ShadowDepth="1"
                                                                BlurRadius="0"
                                                                Opacity="1"
                                                                RenderingBias="Quality"/>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTemplateColumn Width="100">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Content="{Binding VQ3Time}" 
                                                            Tag="vq3" 
                                                            Click="PlayDemo_Click"
                                                            Style="{StaticResource TimeButtonStyle}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Width="100">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Content="{Binding CPMTime}" 
                                                            Tag="cpm" 
                                                            Click="PlayDemo_Click"
                                                            Style="{StaticResource TimeButtonStyle}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Width="50">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Click="ToggleFavorite_Click"
                                                            Background="Transparent"
                                                            BorderThickness="0"
                                                            Padding="0">
                                                        <TextBlock Text="â˜…" 
                                                                   FontSize="19"
                                                                   Margin="0,2,0,0"
                                                                   Foreground="{Binding IsFavorite, Converter={StaticResource FavoriteColorConverter}}">
                                                            <TextBlock.Effect>
                                                                <DropShadowEffect 
                                                                    Color="#FF000000"
                                                                    Direction="315"
                                                                    ShadowDepth="1"
                                                                    BlurRadius="0"
                                                                    Opacity="1"
                                                                    RenderingBias="Quality"/>
                                                            </TextBlock.Effect>
                                                        </TextBlock>
                                                    </Button>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Width="100">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Tag="vq3" 
                                                            Click="LaunchMap_Click"
                                                            Style="{StaticResource LaunchButtonStyle}">
                                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,-1,0,0">
                                                            <TextBlock Text="VQ3" 
                                                                     Foreground="{StaticResource VQ3TextColor}"
                                                                     Effect="{StaticResource ShadowEffect}"/>
                                                            <TextBlock Text=" â–¶" 
                                                                     Foreground="{StaticResource VQ3TextColor}"
                                                                     Margin="3,0,0,0"
                                                                     Effect="{StaticResource ShadowEffect}"/>
                                                        </StackPanel>
                                                    </Button>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Width="100">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Tag="cpm" 
                                                            Click="LaunchMap_Click"
                                                            Style="{StaticResource LaunchButtonStyle}">
                                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,-1,0,0">
                                                            <TextBlock Text="CPM" 
                                                                     Foreground="{StaticResource CPMTextColor}" Effect="{StaticResource ShadowEffect}"/>
                                                            <TextBlock Text=" â–¶" 
                                                                     Foreground="{StaticResource CPMTextColor}" 
                                                                     Margin="3,0,0,0"
                                                                     Effect="{StaticResource ShadowEffect}"/>
                                                        </StackPanel>
                                                    </Button>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </ScrollViewer>
                        </TabItem>
                        <TabItem x:Name="SettingsTab">
                            <TabItem.Header>
                                <TextBlock VerticalAlignment="Center"
                                           Margin="-6,-2,0,0"
                                           Padding="0"
                                           TextOptions.TextFormattingMode="Ideal"
                                           TextOptions.TextRenderingMode="ClearType"
                                           TextOptions.TextHintingMode="Animated"
                                           RenderOptions.ClearTypeHint="Enabled"
                                           UseLayoutRounding="True"
                                           SnapsToDevicePixels="False">
                                    <Span>
                                        <Run Text="ðŸ”§" 
                                             Foreground="Silver"
                                             FontSize="15"/>
                                        <Run Text="Settings"
                                             FontFamily="{StaticResource EternalUiFont}"
                                             FontSize="14"/>
                                    </Span>
                                </TextBlock>
                            </TabItem.Header>
                            <ScrollViewer VerticalScrollBarVisibility="Auto" PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                                <StackPanel Margin="10"
                                    TextOptions.TextFormattingMode="Ideal"
                                    TextOptions.TextRenderingMode="ClearType"
                                    TextOptions.TextHintingMode="Animated"
                                    RenderOptions.ClearTypeHint="Enabled"
                                    UseLayoutRounding="True"
                                    SnapsToDevicePixels="False">
                                    
                                    <!-- Player Name Section -->
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Text="Player Name:" Margin="5" VerticalAlignment="Center"
                                                  Foreground="{DynamicResource TextColor}" Grid.Column="0"
                                                  TextOptions.TextFormattingMode="Ideal"
                                                  TextOptions.TextRenderingMode="ClearType"
                                                  TextOptions.TextHintingMode="Animated"
                                                  RenderOptions.ClearTypeHint="Enabled"
                                                  UseLayoutRounding="True"
                                                  SnapsToDevicePixels="False"/>
                                        
                                        <TextBox x:Name="PlayerNameBox" Margin="5"
                                                Background="{DynamicResource TextBoxBackground}"
                                                Foreground="{DynamicResource TextColor}" Grid.Column="1"
                                                TextOptions.TextFormattingMode="Ideal"
                                                TextOptions.TextRenderingMode="ClearType"
                                                TextOptions.TextHintingMode="Animated"
                                                RenderOptions.ClearTypeHint="Enabled"
                                                UseLayoutRounding="True"
                                                SnapsToDevicePixels="False"/>
                                    </Grid>
                                    
                                    <TextBlock Margin="5,0,5,15" FontSize="10" TextWrapping="Wrap"
                                              FontFamily="{DynamicResource {x:Static SystemFonts.MessageFontFamilyKey}}"
                                              Foreground="#FFD0D0D0"
                                              TextOptions.TextFormattingMode="Ideal"
                                              TextOptions.TextRenderingMode="ClearType"
                                              TextOptions.TextHintingMode="Animated"
                                              RenderOptions.ClearTypeHint="Enabled"
                                              UseLayoutRounding="True"
                                              SnapsToDevicePixels="False">
                                        <Run Text="For correct scanning of personal records on maps, enter the nickname that matches the name specified in the 'df_name' parameter in the DeFRaG configuration."/>
                                        <LineBreak/>
                                        <Run Text="This name should be specified without using color codes."/>
                                        <LineBreak/>
                                        <Run Text="Also, for correct detection of personal records and demos, the demo format must be set in DeFRaG configuration:"/>
                                        <LineBreak/>
                                        <Run Text="seta df_ar_format $map.$-route[$gt.$phys.$-mode]$m.$-s.$-ms($pl.$plc)"/>
                                        <LineBreak/>
                                        <Run Text="More about rules and demo format: "/>
                                        <Hyperlink NavigateUri="https://dfcomps.ru/rules" Foreground="#FF6FA8DC" RequestNavigate="Hyperlink_RequestNavigate">https://dfcomps.ru/rules</Hyperlink>
                                    </TextBlock>
                                    
                                    <!-- DeFRaG Engine Section -->
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Text="DeFRaG Engine:" Margin="5" VerticalAlignment="Center"
                                                  Foreground="{DynamicResource TextColor}" Grid.Column="0"
                                                  TextOptions.TextFormattingMode="Ideal"
                                                  TextOptions.TextRenderingMode="ClearType"
                                                  TextOptions.TextHintingMode="Animated"
                                                  RenderOptions.ClearTypeHint="Enabled"
                                                  UseLayoutRounding="True"
                                                  SnapsToDevicePixels="False"/>
                                        
                                        <TextBox x:Name="EnginePathBox" Margin="5" Text="oDFe.x64.exe"
                                                Background="{DynamicResource TextBoxBackground}"
                                                Foreground="{DynamicResource TextColor}" Grid.Column="1"
                                                TextOptions.TextFormattingMode="Ideal"
                                                TextOptions.TextRenderingMode="ClearType"
                                                TextOptions.TextHintingMode="Animated"
                                                RenderOptions.ClearTypeHint="Enabled"
                                                UseLayoutRounding="True"
                                                SnapsToDevicePixels="False"/>
                                    </Grid>
                                    
                                    <TextBlock Margin="5,0,5,15" FontSize="10" TextWrapping="Wrap"
                                              FontFamily="{DynamicResource {x:Static SystemFonts.MessageFontFamilyKey}}"
                                              Foreground="#FFD0D0D0"
                                              TextOptions.TextFormattingMode="Ideal"
                                              TextOptions.TextRenderingMode="ClearType"
                                              TextOptions.TextHintingMode="Animated"
                                              RenderOptions.ClearTypeHint="Enabled"
                                              UseLayoutRounding="True"
                                              SnapsToDevicePixels="False">
                                        <Run Text="In this field, specify the game engine you use to run DeFRaG."/>
                                        <LineBreak/>
                                        <Run Text="Supported engines:"/>
                                        <LineBreak/>
                                        <Run Text="- oDFe.x64.exe (recommended)"/>
                                        <LineBreak/>
                                        <Run Text="- oDFe.vk.x64.exe"/>
                                        <LineBreak/>
                                        <Run Text="- iDFe.x64.exe"/>
                                        <LineBreak/>
                                        <Run Text="- iDFe.exe"/>
                                        <LineBreak/>
                                        <Run Text="- dfengine.exe"/>
                                        <LineBreak/>
                                        <Run Text="- iDFe-dfwc2021.vk.x64.exe"/>
                                        <LineBreak/>
                                        <Run Text="Engines must launch defrag mod directly without additional parameters."/>
                                        <LineBreak/>
                                        <Run Text="Example: 'cnq3-x64.exe' won't work as it launches 'promode' mod automatically."/>
                                        <LineBreak/>
                                        <Run Text="Recommendation: Use 'oDFe.x64.exe' - currently the most stable and up-to-date engine based on both 'ioquake3' and 'Quake3e'."/>
                                    </TextBlock>
                                    
                                    <!-- Buttons -->
                                    <Button Content="Save Settings" Click="SaveSettings_Click" 
                                           Margin="5" Style="{StaticResource ActionButtonStyle}"
                                           TextOptions.TextFormattingMode="Ideal"
                                           TextOptions.TextRenderingMode="ClearType"
                                           TextOptions.TextHintingMode="Animated"
                                           RenderOptions.ClearTypeHint="Enabled"
                                           UseLayoutRounding="True"
                                           SnapsToDevicePixels="False"/>
                                    
                                    <Button Content="Rescan Maps" Click="RescanMaps_Click" 
                                           Margin="5" Style="{StaticResource ActionButtonStyle}"
                                           TextOptions.TextFormattingMode="Ideal"
                                           TextOptions.TextRenderingMode="ClearType"
                                           TextOptions.TextHintingMode="Animated"
                                           RenderOptions.ClearTypeHint="Enabled"
                                           UseLayoutRounding="True"
                                           SnapsToDevicePixels="False"/>

                                    <!-- Separator -->
                                    <Border Height="1" Background="#FF3A3A3A" Margin="5,15,5,5"/>

                                    <!-- Links Section -->
                                    <TextBlock Margin="5,5,5,5" FontSize="9" TextWrapping="Wrap"
                                             FontFamily="{DynamicResource {x:Static SystemFonts.MessageFontFamilyKey}}"
                                             Foreground="#FFD0D0D0"
                                             TextOptions.TextFormattingMode="Ideal"
                                             TextOptions.TextRenderingMode="ClearType"
                                             TextOptions.TextHintingMode="Animated"
                                             RenderOptions.ClearTypeHint="Enabled"
                                             UseLayoutRounding="True"
                                             SnapsToDevicePixels="False">
                                        <Run Text="My github (and DeFRaG Manager updates): "/>
                                        <Hyperlink NavigateUri="https://github.com/Qz3rK/q3-defrag-manager" Foreground="#FF6FA8DC" RequestNavigate="Hyperlink_RequestNavigate">https://github.com/Qz3rK/q3-defrag-manager</Hyperlink>
                                        <LineBreak/>
                                        <Run Text="oDFe engine: "/>
                                        <Hyperlink NavigateUri="https://github.com/JBustos22/odfe" Foreground="#FF6FA8DC" RequestNavigate="Hyperlink_RequestNavigate">https://github.com/JBustos22/odfe</Hyperlink>
                                        <LineBreak/>
                                        <Run Text="Warcups and competitions: "/>
                                        <Hyperlink NavigateUri="https://dfcomps.ru" Foreground="#FF6FA8DC" RequestNavigate="Hyperlink_RequestNavigate">https://dfcomps.ru</Hyperlink>
                                        <Run Text=" | "/>
                                        <Hyperlink NavigateUri="https://defrag.racing" Foreground="#FF6FA8DC" RequestNavigate="Hyperlink_RequestNavigate">https://defrag.racing</Hyperlink>
                                        <LineBreak/>
                                        <Run Text="Maps: "/>
                                        <Hyperlink NavigateUri="https://ws.q3df.org/maps" Foreground="#FF6FA8DC" RequestNavigate="Hyperlink_RequestNavigate">https://ws.q3df.org/maps</Hyperlink>
                                        <Run Text=" | "/>
                                        <Hyperlink NavigateUri="https://defrag.racing/maps" Foreground="#FF6FA8DC" RequestNavigate="Hyperlink_RequestNavigate">https://defrag.racing/maps</Hyperlink>
                                        <LineBreak/>
                                        <Run Text="Additional info and DFWC: "/>
                                        <Hyperlink NavigateUri="https://q3df.org" Foreground="#FF6FA8DC" RequestNavigate="Hyperlink_RequestNavigate">https://q3df.org</Hyperlink>
                                        <LineBreak/>
                                        <Run Text="DeFRaG mod updates: "/>
                                        <Hyperlink NavigateUri="https://q3defrag.org/files/defrag" Foreground="#FF6FA8DC" RequestNavigate="Hyperlink_RequestNavigate">https://q3defrag.org/files/defrag</Hyperlink>
                                    </TextBlock>

                                    <!-- Separator -->
                                    <Border Height="1" Background="#FF3A3A3A" Margin="5,15,5,5"/>

                                    <!-- Copyright -->
                                    <TextBlock Margin="5,5,5,0" FontSize="9" HorizontalAlignment="Right"
                                              FontFamily="{DynamicResource {x:Static SystemFonts.MessageFontFamilyKey}}"
                                              Foreground="#FFD0D0D0"
                                              TextOptions.TextFormattingMode="Ideal"
                                              TextOptions.TextRenderingMode="ClearType"
                                              TextOptions.TextHintingMode="Animated"
                                              RenderOptions.ClearTypeHint="Enabled"
                                              UseLayoutRounding="True"
                                              SnapsToDevicePixels="False">
                                        <Run Text="Copyright Â© 2025 Qz3rK | "/>
                                        <Hyperlink NavigateUri="https://github.com/Qz3rK" Foreground="#FF6FA8DC" RequestNavigate="Hyperlink_RequestNavigate">https://github.com/Qz3rK</Hyperlink><Run Text=" | DeFRaG Manager (v1.1.0)"/>
                                    </TextBlock>
                                </StackPanel>
                            </ScrollViewer>
                        </TabItem>
                    </TabControl>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Grid>

</Window>